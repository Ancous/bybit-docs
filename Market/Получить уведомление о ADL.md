- [Информация](#информация)
- [Конечная точка](#конечная-точка)
- [Примеры запроса](#примеры-запроса)
- [Параметры запроса](#параметры-запроса)
- [Примеры ответа](#примеры-ответа)
- [Параметры ответа](#параметры-ответа)

<a id="информация"></a>

Запрос оповещений [ADL](https://www.bybit.com/en/help-center/article/Auto-Deleveraging-ADL) (механизм автоматического снижения задолженности) и информации о страховом пуле.

>Зона применения:  
>`linear`  
>
>- Фьючерс USDT/USDC без даты экспирации  
>- Фьючерс USDT/USDC с датой экспирации
>
>`inverse`  
>
>- Обратный Фьючерс без даты экспирации
>- Обратный Фьючерс с датой экспирации
<!-- -->
>Подсказка:  
>Частота обновления данных: каждые 1 минуту
<!-- -->
>Информация:
>
>**Обозначения:**  
>PnL - это отчёт о финансовых результатах  
>`balance` - баланс страхового фонда  
>`adlTriggerThreshold` - порог срабатывания ADL по просадке PnL контракта  
>`pnlRatio` — отношение просадки символа за последние 8 часов  
>`insurancePnlRatio` - пороговое соотношения PnL для срабатывания ADL  
>`maxBalance` - максимальный баланс страхового фонда за 8 часов  
>`adlStopRatio` - пороговое значение для остановки ADL по просадке PnL контракта  
>`текущий PnL символа` и `максимальный PnL за 8 часов` - не предоставляются API.
>
>**Формула `pnlRatio`:**  
>`pnlRatio` = (`текущий PnL символа` – `максимальный PnL символа за 8 часов`) / `maxBalance`
>
>***Условия срабатывания и остановки ADL (автоматического уменьшения левериджа) основаны на следующих трёх случаях:***
>
>- ADL по просадка PnL контракта (на базе нового механизма группового страхового пула, см. примеры 1 и 2)  
>   - Условие срабатывания:  
>     `balance` > `adlTriggerThreshold` and `pnlRatio` <`nsurancePnlRatio`  
>   - Условие остановки:  
>     `pnlRatio` > `adlStopRatio`
>
>- ADL по просадке капитала страхового пула (оригинальный механизм, см. пример 3)
>   - Условие срабатывания:  
>     `balance` ≤ 0
>   - Условие остановки:  
>     `balance` > 0
>
>- Избыточные потери по марже символа после его исключения из группового страхового пула (можно рассматривать как
> частный случай ADL по просадке капитала пула)
>
>   Для обеспечения безопасности пула команда  риск-контроля может исключить символ из группового пула и временно создать
>   для него новый независимый страховой пул.
>
>   - Условие срабатывания:  
>     `balance` ≤ 0
>   - Условие остановки:  
>     `balance` > 0
>
>***Примеры срабатывания ADL: вызов по просадке PnL и балансу страхового пула:***
>
>- Пример 1:
>
>    Пул не получил значительной прибыли за последние 8 часов, затем убыток по символу превышает порог отношения
>    просадки PnL (`insurancePnlRatio`), ADL срабатывает.
>
>   - Предположим, символы A, B и C используют общий пул с начальными 8-часовыми `balance` 1 млн USDT.
>   - Символ A понёс убыток в 350 тыс. USDT.
>   - Расчёт:
>     - `pnlRatio` = -35%
>     - `balance` = 1 млн
>     - `adlTriggerThreshold` = 1 (константа, установленная Bybit)
>     - `insurancePnlRatio` = -0.3 (константа, установленная Bybit)
>   - Проверка условий:
>     - `balance` (1 млн) > `adlTriggerThreshold` (1)
>     - `pnlRatio` (-0.35) < `insurancePnlRatio` (-0.3)
>     - ADL по просадке PnL контракта срабатывает.
>   - Система рассчитывает цену банкротства при просадке -30%, поэтому ADL закрывает позиции пользователя на
>     сумму 50 тыс. USDT, чтобы удержать `pnlRatio` символа A на уровне -30%.
>
>    **Условие остановки:**  
>    ADL прекращается, если `pnlRatio` символа A превысит `adlStopRatio` (-0.25, константа Bybit).
>
>    **Методы восстановления:**
>
>       - Платформа вводит средства в пул и корректирует PnL символа A.
>       - Пул продолжает удерживать позиции символа A и получает маржу обслуживания через ликвидацию на рынке.
>  
>- Пример 2:
>
>    Пул получил значительную прибыль за последние 8 часов, но убыток по символу превышает порог отношения просадки
>    PnL (`insurancePnlRatio`), ADL всё равно срабатывает.
>
>   - Предположим, символы A, B, C используют общий пул с начальными 8-часовыми `balance` 1 млн USDT.
>   - Символ A получил прибыль через ликвидацию, максимальный баланс пула за 8 часов = 2 млн USDT (PnL символа A = +1 млн).
>   - Позже символ A понёс убыток в 600 тыс. USDT.
>   - Расчёт:
>     - `pnlRatio` = -30%
>     - `balance` = 2 млн
>     - `adlTriggerThreshold` = 1 (константа Bybit)
>     - `insurancePnlRatio` = -0.3 (константа Bybit)
>   - Проверка условий:
>     - `balance` (2 млн) > `adlTriggerThreshold` (1)
>     - `pnlRatio` (-0.30) ≤ `insurancePnlRatio` (-0.3)
>     - ADL по просадке PnL контракта срабатывает.
>   - Система рассчитывает цену банкротства при просадке -30%.
>
>    **Условие остановки:**  
>    ADL прекращается, если `pnlRatio` символа A превысит `adlStopRatio` (-0.25).
>
>    **Методы восстановления:**  
>
>       - Платформа вводит средства в пул и корректирует PnL символа A.
>       - Пул продолжает удерживать позиции символа A и получает маржу обслуживания через ликвидацию на рынке.
>
>- Пример 3:
>
>   Баланс пула достигает нуля, что вызывает срабатывание ADL.
>
>   - Предположим, символы A, B, C, D используют общий пул с начальными 8-часовыми `balance` 1 млн USDT.
>   - Хотя значения `pnlRatio` для символов не достигают -30%, `balance` падает до 0.
>   - Проверка условий:
>     - `balance` ≤ 0
>     - ADL по просадке капитала страхового пула срабатывает.
>   - Система перераспределяет убытки банкротства между символами пропорционально их PnL при `balance` = 0.
>
>    **Условие остановки:**  
>    ADL прекращается, если `balance` становится больше 0.

Подпишитесь на тему [ADL WebSocket](https://bybit-exchange.github.io/docs/v5/websocket/public/adl-alert) для более
быстрых обновлений.

<a id="конечная-точка"></a>

## Конечная точка

`/v5/market/adlAlert`

<a id="примеры-запроса"></a>

## Примеры запроса

- HTTP

      ```http
      GET /v5/market/adlAlert?symbol=BTCUSDT HTTP/1.1
      Host: api-testnet.bybit.com
      ```

- Python
  
       ```python
       import requests

       base_url = "https://api-testnet.bybit.com"
       end_point = "/v5/market/adlAlert"

       complete_request = base_url + end_point
       parameters = {
           "symbol": "BTCUSDT"
       }
  
       response = requests.get(url=complete_request, params=parameters, timeout=10)

       print(response.json())
       ```

<a id="параметры-запроса"></a>

## Параметры запроса

|Параметр  	                  |Обязательный	 |Тип   	  |Комментарии                       |По умолчанию|
|-----------------------------|--------------|----------|----------------------------------|------------|
|[symbol](<../20.Определения значений в запросах и ответах.md#symbol>)	  |нет           |string    |Имя символа: `BTCUSDT`, только заглавными буквами |-           |

<a id="примеры-ответа"></a>

## Пример ответа

    ```json
    {
        "retCode": 0,
        "retMsg": "OK",
        "result": {
            "updatedTime": "1757733960000",
            "list": [
                {
                    "coin": "USDT",
                    "symbol": "BTCUSDT",
                    "balance": "92203504694.99632",
                    "maxBalance": "92231510324.75948",
                    "insurancePnlRatio": "-0.3",
                    "pnlRatio": "-0.560973",
                    "adlTriggerThreshold": "10000",
                    "adlStopRatio": "-0.25"
                }
            ]
        },
        "retExtInfo": {},
        "time": 1757734022014
    }
    ```

<a id="параметры-ответа"></a>

## Параметры ответа

|Параметр  |Тип       |Комментарии                                             |
|----------|----------|--------------------------------------------------------|
|updateTime  |string       |Время последнего обновления данных                                             |
|list  |array       |Массив объектов с данными                                             |
|coin  |string       |Токен страхового пула                                             |
|symbol  |string       |Название символа                                             |
|balance  |string       |Баланс страхового фонда. Используется для определения срабатывания ADL  |
|maxBalance  |string       |Максимальный баланс страхового пула за последние 8 часов                                             |
|insurancePnlRatio  |string       |Пороговое значение отношения PnL для срабатывания ADL по просадке контракта<br>ADL срабатывает, когда отношение просадки PnL по символу за последние 8 часов превышает это значение     |
|pnlRatio  |string       |Отношение просадки PnL по символу за последние 8 часов<br>Используется для определения необходимости срабатывания или остановки ADL    |
|adlTriggerThreshold  |string       |Порог срабатывания ADL по просадке PnL контракта<br>Это условие действует только если баланс страхового пула выше этого значения. В таком случае 8-часовая просадка, превышающее n%, может привести к активации ADL.                                             |
|adlStopRatio  |string       |Пороговое значение для остановки ADL по просадке PnL контракта<br>ADL останавливается, когда отношение просадки за 8 часов по символу опускается ниже этого значения                                             |
