- [Информация](#информация)
- [Конечная точка](#конечная-точка)
- [Примеры запроса](#примеры-запроса)
- [Параметры запроса](#параметры-запроса)
- [Примеры ответа](#примеры-ответа)
- [Параметры ответа](#параметры-ответа)

<a id="информация"></a>

Запрос оповещений ADL (механизм автоматического снижения задолженности) и информации о страховом пуле.

>Зона применения:  
>`linear`  
>  - Фьючерс USDT/USDC без даты экспирации  
>  - Фьючерс USDT/USDC с датой экспирации
>
>`inverse`  
>  - Обратный Фьючерс без даты экспирации
>  - Обратный Фьючерс с датой экспирации
<!-- -->
>Информация:  
>Триггер ADL и стоп-условия основаны на следующих трех случаях:  
>1. Контракт PnL drawdown ADL (основан на новом механизме группированного страхового пула, см. примеры 1 и 2)  
>**Условие триггера:**  
>balance (баланс страхового фонда) > adlTriggerThreshold (порог триггера для контракт PnL drawdown ADL)  
>and pnlRatio < insurancePnlRatio (порог PnL ratio для триггера ADL)  
>**Где:**  
>pnlRatio: коэффициент просадки символа за последние 8 часов  
>Формула: pnlRatio = (Current PnL символа - Max PnL символа за 8 часов) / Max balance страхового пула за 8 часов
>(maxBalance)  
>**Примечание:** Current PnL и Max PnL символа за 8 часов не предоставляются API.  
>Max balance страхового пула за 8 часов (maxBalance): максимальный баланс группированного страхового пула за последние
>8 часов  
>**Условие остановки:** pnlRatio > adlStopRatio (порог stop ratio для ADL)  
>2. Insurance pool equity drawdown ADL (оригинальный механизм, см. пример 3)  
>**Условие триггера:** balance (баланс страхового фонда) ≤ 0  
>**Условие остановки:** balance (баланс страхового фонда) > 0  
>3. Excessive margin loss of a symbol after removing it from a grouped insurance pool (можно считать специальным случаем
>pool equity drawdown ADL)  
>Для обеспечения безопасности пула команда риск-контроля может удалить символ из его группированного пула и временно
>установить его как новый независимый страховой пул.  
>**Условие триггера:** balance (баланс страхового фонда) ≤ 0  
>**Условие остановки:** balance (баланс страхового фонда) > 0  

>Примеры ADL: Триггеры по PnL Prosadке и Балансу Страхового Пула  
>**Пример 1: Пул не имеет значительной прибыли за последние 8 часов, затем убыток символа превышает порог PnL ratio
>(insurancePnlRatio), ADL будет триггером**  
>Предположим, символы A, B и C делят один пул с начальным балансом за 8 часов 1M USDT  
>A несет убыток в 350K  
>Расчет:  
>pnlRatio = -35%  
>balance = 1M  
>adlTriggerThreshold = 1 (константа, установленная Bybit)  
>insurancePnlRatio = -0.3 (константа, установленная Bybit)  
>Проверка условия:  
>balance (1M) > adlTriggerThreshold (1)  
>pnlRatio (-0.35) < insurancePnlRatio (-0.3)  
>→ Contract PnL drawdown ADL запускается  
>Система рассчитывает цену банкротства при просадке -30%, так что ADL закрывает позиции пользователей на сумму 50K,
>чтобы сохранить PnL Ratio A на уровне -30%  
>**Условие остановки:** ADL останавливается, если PnL Ratio A > adlStopRatio (-0.25, константа, установленная Bybit)  
>**Методы восстановления:**  
>Платформа вливает средства в пул и корректирует PnL A  
>Пул продолжает принимать позиции A и зарабатывает поддерживающую маржу через ликвидацию на рынке  
>**Пример 2: Пул имеет значительную прибыль за последние 8 часов, но убыток символа превышает порог PnL ratio
>(insurancePnlRatio), ADL все равно запускается**  
>Предположим, символы A, B, C делят один пул, начальный баланс = 1M USDT  
>A получает прибыль через ликвидацию, Max Balance пула за 8 часов = 2M USDT (PnL A = +1M)  
>Позже A несет убыток в 600K  
>Расчет:  
>pnlRatio = -30%  
>balance = 2M  
>adlTriggerThreshold = 1 (константа, установленная Bybit)  
>insurancePnlRatio = -0.3 (константа, установленная Bybit)  
>Проверка условия:  
>balance (2M) > adlTriggerThreshold (1)  
>pnlRatio (-0.30) ≤ insurancePnlRatio (-0.3)  
>→ Contract PnL drawdown ADL запускается  
>Система рассчитывает цену банкротства при просадке -30%  
>**Условие остановки:** ADL останавливается, если PnL Ratio A > adlStopRatio (-0.25, константа, установленная Bybit)  
>**Методы восстановления:**  
>Платформа вливает средства в пул и корректирует PnL A  
>Пул продолжает принимать позиции A и зарабатывает поддерживающую маржу через ликвидацию на рынке  
>**Пример 3: Баланс пула достигает нуля, что вызывает ADL**  
>Предположим, символы A, B, C, D делят один пул, начальный баланс = 1M USDT  
>Несмотря на то, что ни один из PnL Ratio символов не достигает -30%, баланс пула падает до 0  
>Проверка условия:  
>balance (0) ≤ 0  
>→ Insurance pool equity ADL запускается  
>Система перераспределяет убытки банкротства по символам на основе их PnL, когда баланс пула = 0  
>**Условие остановки:** ADL останавливается, если balance > 0

Подпишитесь на тему [ADL WebSocket](https://bybit-exchange.github.io/docs/v5/websocket/public/adl-alert) для более
быстрых обновлений.

<a id="конечная-точка"></a>

## Конечная точка

`/v5/market/adlAlert`

<a id="примеры-запроса"></a>

## Примеры запроса

- HTTP

  ```http
  GET /v5/market/adlAlert&symbol=BTCUSDT HTTP/1.1
  Host: api-testnet.bybit.com
  ```

- Python

  ```python
  import requests

  base_url = "https://api-testnet.bybit.com"
  end_point = "/v5/market/adlAlert"

  complete_request = base_url + end_point
  parameters = {
      "symbol": "BTCUSDT"
  }
  
  response = requests.get(url=complete_request, params=parameters, timeout=10)

  print(response.json())
  ```

<a id="параметры-запроса"></a>

## Параметры запроса

|Параметр  	                  |Обязательный	 |Тип   	  |Комментарии                       |По умолчанию|
|-----------------------------|--------------|----------|----------------------------------|------------|
|[symbol](<../20.Определения значений в запросах и ответах.md#symbol>)	  |нет           |string    |Имя символа: `BTCUSDT`, только заглавными буквами |-           |

<a id="примеры-ответа"></a>

## Пример ответа

```json
{
    "retCode": 0,
    "retMsg": "OK",
    "result": {
        "updatedTime": "1757733960000",
        "list": [
            {
                "coin": "USDT",
                "symbol": "BTCUSDT",
                "balance": "92203504694.99632",
                "maxBalance": "92231510324.75948",
                "insurancePnlRatio": "-0.3",
                "pnlRatio": "-0.560973",
                "adlTriggerThreshold": "10000",
                "adlStopRatio": "-0.25"
            }
        ]
    },
    "retExtInfo": {},
    "time": 1757734022014
}
```

<a id="параметры-ответа"></a>

## Параметры ответа

|Параметр  |Тип       |Комментарии                                             |
|----------|----------|--------------------------------------------------------|
|updateTime  |string       |Комментарии                                             |
|list  |array       |Комментарии                                             |
|coin  |string       |Комментарии                                             |
|symbol  |string       |Комментарии                                             |
|balance  |string       |Комментарии                                             |
|maxBalance  |string       |Комментарии                                             |
|insurancePnlRatio  |string       |Комментарии                                             |
|pnlRatio  |string       |Комментарии                                             |
|adlTriggerThreshold  |string       |Комментарии                                             |
|adlStopRatio  |string       |Комментарии                                             |
