- [Информация](#информация)
- [Рабочий процесс](#рабочий-процесс)
  - [Шаг 1: Получить список конвертируемых монет](#шаг-1-получить-список-конвертируемых-монет)
  - [Шаг 2: Запросить котировки](#шаг-2-запросить-котировки)
  - [Шаг 3: Подтвердить котировки](#шаг-3-подтвердить-котировки)
  - [Шаг 4: Получить статус конвертации](#шаг-4-получить-статус-конвертации)
- [Коды ошибок](#коды-ошибок)
- [Лимиты API](#лимиты-api)

<a id="информация"></a>

## Информация

>Информация:
>
>- Все конечные точки API конвертации требуют аутентификации.
>- Разрешение API-ключа: "Exchange".

<a id="рабочий-процесс"></a>

## Рабочий процесс

<a id="шаг-1-получить-список-конвертируемых-монет"></a>

### Шаг 1: Получить список конвертируемых монет

- Запросите список поддерживаемых монет для конвертации "из" и "в" для разных типов счетов.  
- При запросе списка монет "из" также предоставляется баланс.

<a id="шаг-2-запросить-котировки"></a>

### Шаг 2: Запросить котировки

- Выберите `fromCoin`, `toCoin`, `accoutType`, укажите количество `fromCoin` и получите котировку.  
- На этом этапе выполняется предварительная проверка баланса.

<a id="шаг-3-подтвердить-котировки"></a>

### Шаг 3: Подтвердить котировки

- Подтвердите котировку в течение допустимого времени (15 секунд). После подтверждения система обрабатывает транзакцию.  
- Эта операция асинхронная, поэтому может завершиться неудачей, если средства были выведены. Пожалуйста, проверьте
  результат транзакции на шаге 4.

<a id="шаг-4-получить-статус-конвертации"></a>

### Шаг 4: Получить статус конвертации

- Проверьте окончательный статус конвертации монет.

<a id="коды-ошибок"></a>

## Коды ошибок

| Код    | Сообщение                                                    | Комментарий                                                                                                                                                           |
|--------|--------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 32024  | Превышает порог обмена                                       | Если реальный обменный курс (подтверждение котировки) и предложенный курс (запрос котировки) отличаются более чем на 0,5%, ваша конвертация будет отклонена/отменена. |
| 790000 | Системная ошибка, попробуйте позже.                          | -                                                                                                                                                                     |
| 700000 | Ошибка параметра.                                            | -                                                                                                                                                                     |
| 700001 | Сбой котировки: невозможно использовать дилера.              | -                                                                                                                                                                     |
| 700002 | Сбой котировки: неподдерживаемый тип котировки.              | Когда `requestCoin`=`toCoin` на этапе запроса котировки.                                                                                                              |
| 700003 | Недопустимый статус заказа.                                  | -                                                                                                                                                                     |
| 700004 | Заказ не существует                                          | Проверьте, корректен ли `quoteTxId`<br>Проверьте, соответствует ли `quoteTxId` типу счета.                                                                            |
| 700005 | Ваш доступный баланс недостаточен или кошелек не существует. | -                                                                                                                                                                     |
| 700006 | Нижний предел суммы                                          | Запрашиваемая сумма не может быть меньше `minFromCoinLimit`.                                                                                                          |
| 700007 | Верхний предел суммы                                         | Запрашиваемая сумма не может быть больше `maxFromCoinLimit`.                                                                                                          |
| 700008 | Сбой котировки: истекло время котировки                      | Котировка истекла<br>`QuoteTxId` не существует.                                                                                                                       |
| 700009 | `QuoteTxId` уже использован                                  | Эта ошибка возникает при многократном вызове подтверждения котировки до истечения срока.                                                                              |
| 700010 | Пользователь с кредитом INS не может выполнять конвертацию.  | -                                                                                                                                                                     |
| 700011 | Недопустимая операция                                        | Запрос котировки от пользователя A, но подтверждение от пользователя B.                                                                                               |

<a id="лимиты-api"></a>

## Лимиты API

| Метод | Путь                                     | Лимит   | Обновляемый |
|-------|------------------------------------------|---------|-------------|
| POST  | /v5/asset/exchange/quote-apply           | 50/сек  | Нет         |
| POST  | /v5/asset/exchange/convert-execute       | 50/сек  | Нет         |
| GET   | /v5/asset/exchange/query-coin-list       | 100/сек | Нет         |
| GET   | /v5/asset/exchange/convert-result-query  | 100/сек | Нет         |
| GET   | /v5/asset/exchange/query-convert-history | 100/сек | Нет         |
