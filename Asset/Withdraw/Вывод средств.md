- [Информация](#информация)
- [Конечная точка](#конечная-точка)
- [Примеры запроса](#примеры-запроса)
- [Параметры запроса](#параметры-запроса)
- [Пример ответа](#пример-ответа)
- [Параметры ответа](#параметры-ответа)

<a id="информация"></a>

Запрос на вывод средств

Вывод средств из вашего аккаунта Bybit. Вы можете осуществить перевод вне сети, если целевой адрес кошелька
принадлежит Bybit. Это означает, что плата за блокчейн не взимается.

Обратите внимание, что хотя лимит скорости API для этого эндпоинта составляет 5 запросов/с, существует также
вторичный лимит: вы можете выводить средства только один раз каждые 10 секунд на комбинацию сеть/монета.

>Совет:
>
>- Убедитесь, что вы добавили свой адрес кошелька в белый список [здесь](https://www.bybit.com/user/assets/money-address).
>- Запрос только с помощью API-ключа master-UID
<!-- -->
> Формула:
>
>Формулы вычисляют общую комиссию за обработку (handlingFee) на основе типа комиссии (feeType), процентной комиссии
> за вывод (withdrawPercentageFee) и фиксированной комиссии (withdrawFee). Если процентная комиссия равна нулю,
> взимается только фиксированная плата. Для feeType=0 процент применяется к общему вводу, затем добавляется
> фиксированная плата. Для feeType=1 процент применяется после вычета фиксированной платы. Обратитесь к документации
> Bybit за точными значениями и единицами измерения.
>
>- `feeType`=`0`:
>   - Если `withdrawPercentageFee` != `0`:  
>     `handlingFee` = `inputAmount` / (1 - `withdrawPercentageFee`) * `withdrawPercentageFee` + `withdrawFee`
>   - Если `withdrawPercentageFee` = `0`:  
>     `handlingFee` = `withdrawFee`
>- `feeType`=`1`:
>   - Если `withdrawPercentageFee` != `0`:  
>     `handlingFee` = `withdrawFee` + (`inputAmount` - `withdrawFee`) * `withdrawPercentageFee`
>   - Если `withdrawPercentageFee` = `0`:  
>     `handlingFee` = `withdrawFee`


<a id="конечная-точка"></a>

## Конечная точка

`/v5/asset/withdraw/create`

<a id="примеры-запроса"></a>

## Примеры запроса

- HTTP

  ```http
  POST /v5/asset/withdraw/create HTTP/1.1
  Host: api-testnet.bybit.com
  X-BAPI-API-KEY: "<api_key от биржи bybit>"
  X-BAPI-SIGN: <подпись>
  X-BAPI-TIMESTAMP: 1672196570254
  X-BAPI-RECV-WINDOW: 5000
  Content-Type: application/json
  
  {
      "coin": "USDT",
      "chain": "ETH",
      "address": "0x99ced129603abc771c0dabe935c326ff6c86645d",
      "amount": "24",
      "timestamp": 1672196561407,
      "forceChain": 0,
      "accountType": "FUND"
  }
  ```

- собственная реализация

  ```python
  import time
  import hmac
  import hashlib
  import json
  import requests

  base_url = "https://api-testnet.bybit.com"
  end_point = "/v5/asset/withdraw/create"
  complete_request = base_url + end_point

  api_key = "<api_key от биржи bybit>"
  secret_key = "<secret_key от биржи bybit>"
  time_stamp = str(int(time.time() * 1000))
  recv_window = "5000"

  data = {
      "coin": "USDT",
      "chain": "ETH",
      "address": "0x99ced129603abc771c0dabe935c326ff6c86645d",
      "amount": "24",
      "timestamp": 1672196561407,
      "forceChain": 0,
      "accountType": "FUND",
  }

  param_str = time_stamp + api_key + recv_window + json.dumps(data)
  
  signature = hmac.new(
      key=secret_key.encode("utf-8"),
      msg=param_str.encode("utf-8"),
      digestmod=hashlib.sha256
  ).hexdigest()
  
  headers = {
    "X-BAPI-API-KEY": api_key,
    "X-BAPI-SIGN": signature,
    "X-BAPI-TIMESTAMP": time_stamp,
    "X-BAPI-RECV-WINDOW": recv_window,
  }

  response = requests.post(url=complete_request, headers=headers, json=data, timeout=10)

  print(response.json())
  ```

- pybit

  ```python
  from pybit.unified_trading import HTTP

  session = HTTP(
      testnet=True,
      api_key="<api_key от биржи bybit>",
      api_secret="<secret_key от биржи bybit>",
  )
  print(session.withdraw(
      coin="USDT",
      chain="ETH",
      address="0x99ced129603abc771c0dabe935c326ff6c86645d",
      amount="24",
      timestamp=1672196561407,
      forceChain=0,
      accountType="FUND",
  ))
  ```

<a id="параметры-запроса"></a>

## Параметры запроса

|Параметр  	                                                   |Обязательный	 |Тип  	  |Комментарии       |По умолчанию|
|--------------------------------------------------------------|---------------|--------|------------------|------------|
|coin                                                      |да  |string     |***Базовая монета.***<br><br>Только заглавными буквами       |-   |
|chain                                                      |нет  |string     |***Сеть***<br><br>Если `forceChain`=`0` или `1` - это поле обязательно для заполнения<br>Если `forceChain`=`2` - это поле может быть пустым       |-   |
|address                                                      |да  |string     |***Адрес или UID***<br><br>Если `forceChain`=`0` или `1`: обязательно присутствие вводимого адреса в [адресной книге](https://www.bybit.com/user/assets/money-address). Обратите внимание, что адрес чувствителен к регистру, поэтому используйте тот же адрес, что и в адресной книге.<br>Если `forceChain`=`2`: обязательно присутствие вводимого UID в [адресной книге](https://www.bybit.com/user/assets/money-address). Это может быть только другой UID основного счёта Bybit.       |-   |
|tag                                             |нет  |string     |***Тег***<br><br>Требуется, если тег присутствует в списке адресов кошелька.<br>Не добавляйте тег/заметку в адресную книгу, если сеть не поддерживает теги.       |-   |
|amount                                                      |да  |string     |***Сумма вывода***       |-   |
|timestamp                                                      |да  |integer     |***Текущая временная метка.***<br><br>Используется для предотвращения повторного вывода средств.       |-   |
|forceChain                                                      |нет  |integer     |***Выполнять ли принудительный вывод средств в блокчейне***<br><br>`0`: Если адрес распознан как внутренний, то внутренний перевод (только для основного счёта Bybit)<br>`1`: Выполнять ли принудительный вывод средств в блокчейне<br>`2`: Использовать UID для вывода       |`0`   |
|accountType                                                      |да  |string     |***Кошелёк для вывода средств.***<br><br>- `FUND`: Вывод с финансового кошелька.<br>- `UTA`: Система переведёт средства из единого кошелька на финансовый кошелёк для вывода.<br>- `FUND,UTA`: При комбинированном выводе средства сначала списываются с финансового кошелька, если баланс недостаточен, оставшаяся сумма будет списана с кошелька UTA.<br>- `SPOT`: Вывод со спотового кошелька (только для классического счёта).       |-   |
|feeType                                                      |нет  |integer     |***Вариант учёта комиссии за обработку***<br><br>`0`: введённая сумма соответствует фактической полученной сумме, поэтому вам придётся рассчитать комиссию за обработку вручную.<br>`1`: введённая сумма не соответствует фактической полученной сумме, поэтому система автоматически вычтет комиссию за обработку.       |`0`  |
|requestId                                                      |нет  |string     |***Индивидуальный идентификатор***<br><br>- Глобально уникальный<br>- Используется для идемпотентной проверки.<br>- Комбинация букв (с учетом регистра) и цифр, которая может состоять только из букв или только из цифр. Длина должна быть от 1 до 32 символов.       |-   |
|beneficiary                                                   |нет  |Object     |***Объект с дополнительными аргументами для перевода.***<br><br>- Требуется для пользователей зарегистрированных из Кореи, Индии, Турции, Казахстана, Индии и Индонезии.          |-   |
|vaspEntityId (данные объекта `beneficiary`)                   |нет  |Object     |-        |- |
|vaspEntityId (данные объекта `beneficiary`)                   |нет  |string     |***Идентификатор биржи получателя***<br><br>- Чтобы получить этот идентификатор вызовите эту [конечную точку](</Asset/Withdraw/Получить список обменных сущностей.md>).<br>- Обязательный параметр для корейских пользователей.<br>- Игнорируется пользователями из Турции и Казахстана.       |-   |
|beneficiaryName (данные объекта `beneficiary`)                |нет  |string     |***KYC имя получателя***<br><br>- Это имя физического лица или название компании.<br>- KYC имя можно посмотреть в верификация KYC в настройках аккаунта<br>- Обязательный параметр для пользователей из Турции, Казахстана и Индии.<br>- Для пользователей из кореи если `vaspEntityId`=`"others"`, это поле может быть пустым.             |-   |
|beneficiaryLegalType (данные объекта `beneficiary`)           |нет  |string     |***Правовой тип бенефициара***<br><br>- `individual`, `company`<br>- Обязательный параметр для пользователей из Турции, Казахстана и Индии<br>- Пользователи из Кореи могут игнорировать        |`individual`|
|beneficiaryWalletType (данные объекта `beneficiary`)          |нет  |string     |***Тип кошелька получателя***<br><br>- `0`: кастодиальный/биржевой кошелек `1`: некастодиальный/небиржевой кошелек<br>- Обязательный параметр для пользователей из Турции, Казахстана и Индии<br>- Пользователи из Кореи могут игнорировать    |`0`   |
|beneficiaryUnhostedWalletType (данные объекта `beneficiary`)  |нет  |string     |***Тип кошелька получателя без хранения***<br><br>- `0`: ваш собственный кошелек  `1`: чужой кошелек<br>- Обязательный параметр для пользователей из Турции, Казахстана и Индии, если `beneficiaryWalletType`=`1`<br>- Пользователи из Кореи могут игнорировать       |-   |
|beneficiaryPoiNumber (данные объекта `beneficiary`)           |нет  |string     |***Номер документа получателя***<br><br>- Обязательный параметр для пользователей из Турции и Казахстана<br>- Пользователи из Кореи могут игнорировать              |-   |
|beneficiaryPoiType (данные объекта `beneficiary`)             |нет  |string     |***Тип документа получателя***<br><br>- Обязательный параметр для пользователей из Турции и Казахстана<br>- Пользователи из Кореи могут игнорировать       |-   |
|beneficiaryPoiIssuingCountry (данные объекта `beneficiary`)   |нет  |string     |***Страна, выдавшая документ получателя***<br><br>- Обязательный параметр для пользователей из Турции и Казахстана<br>- Посмотреть код страны [Alpha-3](https://www.iban.com/country-codes)<br>- Пользователи из Кореи могут игнорировать       |-   |
|beneficiaryPoiExpiredDate (данные объекта `beneficiary`)      |нет  |string     |***Срок действия документа получателя***<br><br>- Обязательный параметр для пользователей из Турции и Казахстана<br>- Формат: "гггг-мм-дд". Пример: "1990-02-15".<br>- Пользователи из Кореи могут игнорировать.       |-   |
|beneficiaryAddressCountry (данные объекта `beneficiary`)      |нет  |string     |***Страна получателя***<br><br>Обязательный параметр только для пользователей из ОАЭ                                        |-   |
|beneficiaryAddressState (данные объекта `beneficiary`)        |нет  |string     |***Штат получателя***<br><br>Обязательный параметр только для пользователей из ОАЭ                                 |-   |
|beneficiaryAddressCity (данные объекта `beneficiary`)         |нет  |string     |***Город получателя***<br><br>Обязательный параметр только для пользователей из ОАЭ                          |-   |
|beneficiaryAddressBuilding (данные объекта `beneficiary`)     |нет  |string     |***Адрес здания получателя***<br><br>Обязательный параметр только для пользователей из ОАЭ                   |-   |
|beneficiaryAddressStreet (данные объекта `beneficiary`)       |нет  |string     |***Адрес получателя***<br><br>Обязательный параметр только для пользователей из ОАЭ                   |-   |
|beneficiaryAddressPostalCode (данные объекта `beneficiary`)   |нет  |string     |***Почтовый индекс адреса получателя***<br><br>Обязательный параметр только для пользователей из ОАЭ               |-   |
|beneficiaryDateOfBirth (данные объекта `beneficiary`)         |нет  |string     |***Дата рождения получателя***<br><br>Обязательный параметр только для пользователей из ОАЭ              |-   |
|beneficiaryPlaceOfBirth (данные объекта `beneficiary`)        |нет  |string     |***Место рождения получателя***<br><br>Обязательный параметр только для пользователей из ОАЭ       |-   |

<a id="пример-ответа"></a>

## Пример ответа

```json
{
    "retCode": 0,
    "retMsg": "success",
    "result": {
        "id": "10195"
    },
    "retExtInfo": {},
    "time": 1672196571239
}
```

<a id="параметры-ответа"></a>

## Параметры ответа

|Параметр  |Тип       |Комментарии                                             |
|----------|----------|--------------------------------------------------------|
|id   |string      |Идентификатор вывода средств                                             |
