- [Информация](#информация)
- [Конечная точка](#конечная-точка)
- [Примеры запроса](#примеры-запроса)
- [Параметры запроса](#параметры-запроса)
- [Пример ответа](#пример-ответа)
- [Параметры ответа](#параметры-ответа)

<a id="информация"></a>

Запрос данных по открытым и закрытым заказам

>Зона применения:  
>
>`spot` - спот  
>`option` - опцион  
>`linear` - контракт (расчет в USDT, USDC, ...)
>
> - `Perpetual` - контракт без даты экспирации
> - `Futures` - контракт с датой экспирации
>
>`inverse` - контракт (расчет в BTC, ETH, ...)
>
> - `Perpetual` - контракт без даты экспирации
> - `Futures` - контракт с датой экспирации
<!-- -->
>Информация:
>
>- В первую очередь, запрашивает невыполненные или частично выполненные ордера в режиме реального времени, но также
> запрос поддерживает последние 500 закрытых ордеров (отменённые, выполненные). См. использование параметра
> запроса `openOnly`.
>- Спотовый ордер на классическом счёте может возвращать только открытые ордера.
>- После запуска или перезапуска сервера для получения информации о выполненных, отменённых и отклонённых ордерах
> единого счёта, а также для доступа к более старым ордерам, используйте интерфейс
> [истории ордеров](<Получить историю ордеров.md>).
<!-- -->
>Совет:
>
>- UTA 2.0 позволяет запрашивать выполненные, отменённые и отклонённые ордера по последним 500 ордерам для `spot`,
> `linear`, `inverse` и `option`.
>- UTA 1.0 поддерживает аналогичный запрос только для `spot`, `linear` и `option` - ограничение по 500 ордерам на
> обратную категорию не распространяется.
>- Запросы можно выполнять с использованием следующих параметров: `symbol`, `baseCoin`, `orderId` и `orderLinkId`.
>- Если указано несколько параметров, система обработает их в порядке приоритета:
> `orderId` > `orderLinkId` > `symbol` > `baseCoin`.
>- Результаты сортируются по времени создания — от новых к старым.

<a id="конечная-точка"></a>

## Конечная точка

`/v5/order/realtime`

<a id="примеры-запроса"></a>

## Примеры запроса

- HTTP

  ```http
  GET /v5/order/realtime?symbol=ETHUSDT&category=linear&openOnly=0&limit=1  HTTP/1.1
  Host: api-testnet.bybit.com
  X-BAPI-API-KEY: "<api_key от биржи bybit>"
  X-BAPI-SIGN: <подпись>
  X-BAPI-TIMESTAMP: 1672219525810
  X-BAPI-RECV-WINDOW: 5000
  Content-Type: application/json
  ```

- requests

  ```python
  import time
  import hmac
  import hashlib
  import requests

  from urllib.parse import urlencode
  
  base_url = "https://api-testnet.bybit.com"
  end_point = "/v5/order/realtime"
  complete_request = base_url + end_point

  api_key = "<api_key от биржи bybit>"
  secret_key = "<api_secret от биржи bybit>"
  time_stamp = str(int(time.time() * 1000))
  recv_window = "5000"

  data = {
      "category": "linear",
      "symbol": "ETHUSDT",
      "openOnly": 0,
      "limit": 1,
  }

  param_str = time_stamp + api_key + recv_window + urlencode(data)
  
  signature = hmac.new(
      key=secret_key.encode("utf-8"),
      msg=param_str.encode("utf-8"),
      digestmod=hashlib.sha256
  ).hexdigest()
  
  headers = {
    "X-BAPI-API-KEY": api_key,
    "X-BAPI-SIGN": signature,
    "X-BAPI-TIMESTAMP": time_stamp,
    "X-BAPI-RECV-WINDOW": recv_window,
  }

  response = requests.get(url=complete_request, headers=headers, params=data, timeout=10)

  print(response.json())
  ```

- pybit

  ```python
  from pybit.unified_trading import HTTP

  session = HTTP(
      testnet=True,
      api_key="<api_key от биржи bybit>",
      api_secret="<api_secret от биржи bybit>",
  )
  print(session.get_open_orders(
      category="linear",
      symbol="ETHUSDT",
      openOnly=0,
      limit=1,
  ))
  ```

<a id="параметры-запроса"></a>

## Параметры запроса

|Параметр  	                  |Обязательный	 |Тип  	  |Комментарии &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;               |По умолчанию|
|-----------------------------|--------------|--------|------------------|------------|
|[category](<../19.Определения значений в запросах и ответах.md#category>)	|да           |string    |***Тип продукта.***<br><br>- классический аккаунт: `spot`, `linear`, `inverse`<br>- UTA2.0, UTA1.0: `spot`, `linear`, `inverse`, `option`  |-   |
|[symbol](<../19.Определения значений в запросах и ответах.md#symbol>)	    |нет            |string    |***Имя символа.***<br><br>- Только заглавными буквами<br>- Для `linear` требуется любой из параметров: baseCoin, settleCoin. |-   |
|baseCoin                     |нет  |string     |***Базовая монета.***<br><br>- Поддерживает `linear`, `inverse` и `option`<br><br>- только заглавные буквы<br>- `option`: возвращает все открытые опционные ордера<br>&nbsp;&nbsp;&nbsp;по умолчанию       |-   |
|settleCoin                     |нет  |string     |***Расчетная монета.***<br><br>- `linear`: требуется символ, `baseCoin` или `settleCoin`<br>- `spot`: не поддерживается<br>- `option`: USDT или USDC       |-   |
|orderId                     |нет  |string     |***Идентификатор ордера.***<br><br>Требуется либо `orderId`, либо `orderLinkId`.     |-   |
|orderLinkId                     |нет  |string     |***Пользовательский идентификатор ордера.***<br><br>Требуется либо `orderId`, либо `orderLinkId`.   |-   |
|openOnly                     |нет  |integer     |***Фильтр только открытых ордеров.***<br><br>- `0` : [UTA2.0](<../13.Различные режимы аккаунтов.md#единый-торговый-аккаунт-2.0>), [UTA1.0](<../13.Различные режимы аккаунтов.md#единый-торговый-аккаунт-1.0>), классический аккаунт — запрос только открытых<br>&nbsp;&nbsp;&nbsp;ордеров (например, «Новый», «Частично выполнен»)<br>- `1`: [UTA2.0](<../13.Различные режимы аккаунтов.md#единый-торговый-аккаунт-2.0>), [UTA1.0](<../13.Различные режимы аккаунтов.md#единый-торговый-аккаунт-1.0>) (кроме `inverse`)<br>- `2`: [UTA1.0](<../13.Различные режимы аккаунтов.md#единый-торговый-аккаунт-1.0>) (`inverse`), классический аккаунт<br>&nbsp;&nbsp;&nbsp;Запросить можно максимум 500 последних записей со статусом<br>&nbsp;&nbsp;&nbsp;«закрыто» для каждой учетной записи по каждой категории<br>&nbsp;&nbsp;&nbsp;(например, отменённые, отклонённые, исполненные ордера).<br>&nbsp;&nbsp;&nbsp;Если сервис Bybit перезапускается из-за обновления, эта часть<br>&nbsp;&nbsp;&nbsp;данных будет очищена и накапливаться заново, однако записи<br>&nbsp;&nbsp;&nbsp;ордеров по-прежнему будут доступны при <br>&nbsp;&nbsp;&nbsp;[истории ордеров](<Получить историю ордеров.md>).<br>- `openOnly` будет проигнорирован при запросе по `orderId`<br>&nbsp;&nbsp;&nbsp;или `orderLinkId`.<br>- `spot`: не поддерживается.    |`0`   |
|orderFilter                     |нет  |string     |***Управление резервированием активов и поведением ордера до срабатывания.***<br><br>`Order`: активный ордер<br>`StopOrder`: условный ордер для фьючерсов и спота<br>`tpslOrder`: спотовый ордер TP/SL<br>`OcoOrder`: спотовый ордер OCO<br>`BidirectionalTpslOrder`: спотовый двунаправленный ордер TPSL<br>- Классический аккаунт `spot`: по умолчанию возвращаются<br>&nbsp;&nbsp;&nbsp;активные ордера.<br>- В остальных случаях: по умолчанию возвращаются все типы<br>&nbsp;&nbsp;&nbsp;ордеров.       |-   |
|limit                     |нет  |integer     |***Ограничение количества данных на странице.***<br><br>от `1` до `50`       |`20`   |
|cursor                     |нет  |string     |***Курсор.***<br><br>Используйте значение `nextPageCursor` из ответа для получения следующей страницы набора результатов       |-   |

<a id="пример-ответа"></a>

## Примеры ответа

```json
{
    "retCode": 0,
    "retMsg": "OK",
    "result": {
        "list": [
            {
                "orderId": "fd4300ae-7847-404e-b947-b46980a4d140",
                "orderLinkId": "test-000005",
                "blockTradeId": "",
                "symbol": "ETHUSDT",
                "price": "1600.00",
                "qty": "0.10",
                "side": "Buy",
                "isLeverage": "",
                "positionIdx": 1,
                "orderStatus": "New",
                "cancelType": "UNKNOWN",
                "rejectReason": "EC_NoError",
                "avgPrice": "0",
                "leavesQty": "0.10",
                "leavesValue": "160",
                "cumExecQty": "0.00",
                "cumExecValue": "0",
                "cumExecFee": "0",
                "timeInForce": "GTC",
                "orderType": "Limit",
                "stopOrderType": "UNKNOWN",
                "orderIv": "",
                "triggerPrice": "0.00",
                "takeProfit": "2500.00",
                "stopLoss": "1500.00",
                "tpTriggerBy": "LastPrice",
                "slTriggerBy": "LastPrice",
                "triggerDirection": 0,
                "triggerBy": "UNKNOWN",
                "lastPriceOnCreated": "",
                "reduceOnly": false,
                "closeOnTrigger": false,
                "smpType": "None",
                "smpGroup": 0,
                "smpOrderId": "",
                "tpslMode": "Full",
                "tpLimitPrice": "",
                "slLimitPrice": "",
                "placeType": "",
                "createdTime": "1684738540559",
                "updatedTime": "1684738540561",
                "cumFeeDetail": {
                    "MNT": "0.00242968"
                }
            }
        ],
        "nextPageCursor": "page_args%3Dfd4300ae-7847-404e-b947-b46980a4d140%26symbol%3D6%26",
        "category": "linear"
    },
    "retExtInfo": {},
    "time": 1684765770483
}
```

<a id="параметры-ответа"></a>

## Параметры ответа

| Параметр        | Тип       |Описание                                            |
|-----------------|-----------|---------------------------------------------------------|
|category        |string    |Тип продукта|
|nextPageCursor  |string    |Метка для следующей страницы (используется в параметре запроса `cursor` для пагинации)  |
|list            |array     |Массив объектов|
|orderId         |string    |ID ордера|
|orderLinkId     |string    |Пользовательский ID ордера|
|blockTradeId    |string    |ID сделки блоком Paradigm|
|symbol          |string    |Название символа|
|price           |string    |Цена ордера|
|qty             |string    |Количество ордера|
|side            |string    |Сторона сделки<br>- `Buy`<br>- `Sell`|
|isLeverage      |string    |Заёмные средства.<br>UTA `spot` только.<br>`0`: нет, `1`: да. Классический аккаунт `spot` не поддерживается, всегда `0`|
|[positionIdx](<../19.Определения значений в запросах и ответах.md#positionIdx>)      |integer   |Индекс позиции.<br>Используется для идентификации позиций в разных режимах|
|[orderStatus](<../19.Определения значений в запросах и ответах.md#orderStatus>)       |string    |Статус ордера|
|[createType](<../19.Определения значений в запросах и ответах.md#createType>)        |string    |Тип создания ордера<br>Только для `category`=`linear` или `inverse`<br>`spot`, `option` этого параметра не имеют |
|[cancelType](<../19.Определения значений в запросах и ответах.md#cancelType>)       |string    |Тип отмены|
|[rejectReason](<../19.Определения значений в запросах и ответах.md#rejectReason>)    |string    |Причина отклонения.<br>Классический аккаунт `spot` не поддерживается|
|avgPrice        |string    |Средняя цена входа<br>UTA: возвращает `""` для ордеров без средней цены<br>Классический аккаунт: возвращает `"0"` для ордеров без средней цены и частично исполненных, но отменённых в конце |
|leavesQty       |string    |Оставшееся количество.<br>Классический аккаунт `spot` не поддерживается|
|leavesValue     |string    |Остаток стоимости.<br>Классический аккаунт `spot` не поддерживается|
|cumExecQty      |string    |Общее количество выполненных ордеров|
|cumExecValue    |string    |Накопленная стоимость исполненного ордера.<br>Классический аккаунт `spot` не поддерживается|
|cumExecFee      |string    |***Устаревшее***. Накопленная комиссия за совершение торговых операций.<br>Классический аккаунт `spot` не поддерживается|
|[timeInForce](<../19.Определения значений в запросах и ответах.md#timeInForce>)     |string    |Время действия|
|[orderType](<../19.Определения значений в запросах и ответах.md#orderType>)        |string    |Тип ордера `Market`, `Limit`.<br>Для профита/стоп-лосса — тип ордера после срабатывания|
|[stopOrderType](<../19.Определения значений в запросах и ответах.md#stopOrderType>)   |string    |Тип стоп-ордера|
|orderIv         |string    |Предполагаемая волатильность|
|marketUnit      |string    |Единица `qty` при создании `pot` market orders для единого аккаунта `baseCoin`, `quoteCoin` |
|triggerPrice    |string    |Цена срабатывания.<br>Если `stopOrderType`=`TrailingStop`, это активирующая цена. Иначе — цена триггера |
|takeProfit      |string    |Цена тейк-профита|
|stopLoss        |string    |Цена стоп-лосса|
|tpslMode        |string    |Режим тейк-профит/стоп-лосс:<br>`Full` — весь объём позиции для тейк-профита/стоп-лосса;<br>`Partial` — частичный объём позиции<br>`spot` не поддерживается<br>`option` всегда возвращает "" |
|ocoTriggerBy    |string    |Тип триггера Spot OCO ордера `OcoTriggerByUnknown`, `OcoTriggerByTp`, `OcoTriggerBySl`.<br>Классический аккаунт `spot` не поддерживается |
|tpLimitPrice    |string    |Цена лимитного ордера при срабатывании тейк-профита|
|slLimitPrice    |string    |Цена лимитного ордера при срабатывании стоп-лосса|
|[tpTriggerBy](<../19.Определения значений в запросах и ответах.md#triggerBy>)     |string    |Тип цены для срабатывания тейк-профита|
|[slTriggerBy](<../19.Определения значений в запросах и ответах.md#triggerBy>)     |string    |Тип цены для срабатывания стоп-лосса|
|triggerDirection|integer   |Направление триггера:<br>`1` — рост,<br>`2` — падение|
|[triggerBy](<../19.Определения значений в запросах и ответах.md#triggerBy>)       |string    |Тип цены триггера|
|lastPriceOnCreated | string |Последняя цена при размещении ордера,<br>`spot` не поддерживается.|
|basePrice       |string    |Последняя цена при размещении ордера,<br>`spot` поддерживается.|
|reduceOnly      |boolean   |Что такое ордер [`reduceOnly`](https://www.bybit.com/en/help-center/article/Reduce-Only-Order)?.<br>`true` - уменьшение размера позиции|
|closeOnTrigger  |boolean   |Закрыть при срабатывании триггера. [Что такое закрытие по триггерному приказу?](https://www.bybit.com/en/help-center/article/Close-On-Trigger-Order) |
|placeType       |string    |Тип размещения, используется для `option`: `iv`, `price`|
|[smpType](<../19.Определения значений в запросах и ответах.md#smpType>)          |string    |Тип исполнения SMP|
|smpGroup        |integer   |ID группы SMP. По умолчанию `0`, если нет группы|
|smpOrderId      |string    |ID встречного ордера, который вызвал исполнение SMP|
|createdTime     |string    |Временная метка создания ордера (в миллисекундах)|
|updatedTime     |string    |Временная метка обновления ордера (в миллисекундах)|
|cumFeeDetail    |json      |Информация о совокупной торговой комиссии вместо `cumExecFee`|
