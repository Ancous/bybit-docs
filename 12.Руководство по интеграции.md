- [Ресурсы API и каналы поддержки](#ресурсы-api-и-каналы-поддержки)
- [Аутентификация](#aутентификация)
  - [Выбор типа API-ключа](#выбор-типа-api-ключа)
  - [HTTP-заголовки для аутентифицированных конечных точек](#http-заголовки-для-аутентифицированных-конечных-точек)
  - [Создание запроса](#создание-запроса)
- [Общие параметры ответа](#общие-параметры-ответа)

<a id="ресурсы-api-и-каналы-поддержки"></a>

> Совет:  
>Чтобы узнать больше о V5 API, пожалуйста, прочитайте [введение](11.Введение.md#обзор).

## Ресурсы API и каналы поддержки

- [Центр помощи](https://www.bybit.com/en/help-center/topic-list?language=en_US)
- [Официальный Python SDK](https://github.com/bybit-exchange/pybit)
- [Официальный Go SDK](https://github.com/bybit-exchange/bybit.go.api)
- [Официальный Java SDK](https://github.com/bybit-exchange/bybit-java-api)
- [Официальный .Net SDK](https://github.com/bybit-exchange/bybit.net.api)
- [Сообщественный Node.js SDK](https://www.npmjs.com/package/bybit-api)
- [Telegram - Группа обсуждения API](https://t.me/BybitAPI)
- [Discord](https://discord.gg/3ZDjGBNvKR)
- [Коллекция Postman](https://github.com/bybit-exchange/QuickStartWithPostman)
- [Примеры использования API](https://github.com/bybit-exchange/api-usage-examples)

<a id="aутентификация"></a>

## Аутентификация

>Информация:  
>Пожалуйста, посетите [тестовую сеть](https://testnet.bybit.com/app/user/api-management) или
[основную сеть](https://www.bybit.com/app/user/api-management) Bybit для генерации API-ключа.

Базовый эндпоинт REST API:

- Тестовая сеть:
`https://api-testnet.bybit.com`
- Основная сеть (доступны оба эндпоинта):
`https://api.bybit.com`
`https://api.bytick.com`

>Важно:
>
>- Пользователи из Нидерландов: используйте <https://api.bybit.nl> для основной сети
>- Пользователи из Турции: используйте <https://api.bybit-tr.com> для основной сети
>- Пользователи из Казахстана: используйте <https://api.bybit.kz> для основной сети
>- Пользователи из Грузии: используйте <https://api.bybitgeorgia.ge> для основной сети
>- Пользователи из ОАЭ: используйте <https://api.bybit.ae> для основной сети

<a id="выбор-типа-api-ключа"></a>

### Выбор типа API-ключа

API-ключи, сгенерированные системой:
API-ключ, созданный системой Bybit, работает с шифрованием HMAC. Вам будет предоставлена пара публичного и приватного
ключей. Пожалуйста, относитесь к этой паре ключей как к паролям и храните их в безопасности.

- Следуйте примерам [скриптов HMAC](https://github.com/bybit-exchange/api-usage-examples) для завершения процедуры
  шифрования.

Автоматически сгенерированные API-ключи:
API-ключи, созданные самостоятельно, работают с шифрованием RSA. Вы должны создать свои публичный и приватный ключи с
помощью программного обеспечения, а затем предоставить только публичный ключ Bybit — приватный ключ мы никогда
не храним.

- Используйте [api-rsa-generator](https://github.com/bybit-exchange/api-rsa-generator) для создания RSA приватного и
  публичного ключей.
- Следуйте примерам [скриптов RSA](https://github.com/bybit-exchange/api-usage-examples) для завершения процедуры
  шифрования.

<a id="http-заголовки-для-аутентифицированных-конечных-точек"></a>

### HTTP-заголовки для аутентифицированных конечных точек

Следующие ключи HTTP-заголовков должны использоваться для аутентификации:

- `X-BAPI-API-KEY` - API-ключ
- `X-BAPI-TIMESTAMP` - временная метка UTC в миллисекундах
- `X-BAPI-SIGN` - подпись, полученная из параметров запроса
- `X-Referer` или `Referer` - заголовок только для пользователей брокера

Мы также предоставляем X-BAPI-RECV-WINDOW (единица измерения в миллисекундах, значение по умолчанию 5000) для указания
срока действия HTTP-запроса. Он также используется для предотвращения повторных атак.

Меньшее значение `X-BAPI-RECV-WINDOW` более безопасно, но ваш запрос может завершиться неудачей, если время передачи
превышает ваше `X-BAPI-RECV-WINDOW`.

>Внимание:  
>Пожалуйста, убедитесь, что параметр timestamp соответствует следующему правилу:  
>`server_time - recv_window <= timestamp < server_time + 1000`  
>это означает, что ваш timestamp должен находиться в диапазоне: [server_time - recv_window; server_time + 1000)  
>server_time обозначает время сервера Bybit, которое можно запросить через эндпоинт [/v5/market/time](#). Помните,
>что настоятельно рекомендуется использовать время локального устройства для timestamp и всегда держать его
>синхронизированным с NTP.

<a id="создание-запроса"></a>

### Создание запроса

>Совет:  
>Для помощи в диагностике сложных проблем сети вы можете рассмотреть добавление `cdn-request-id` в заголовки вашего
>запроса. Его значение должно быть уникальным для каждого запроса.

Основные шаги:

  1. Вычислите строку, которую хотите подписать, следующим образом:
     - Для GET-запросов:
       `timestamp + API key + recv_window + queryString`.
     - Для POST-запросов:
       `timestamp + API key + recv_window + jsonBodyString`.
  2. Используйте алгоритм **HMAC_SHA256** или **RSA_SHA256** для подписания строки из шага 1 и преобразуйте её в строку
    в нижнем регистре HEX для HMAC_SHA256 или base64 для RSA_SHA256, чтобы получить строковое значение  вашей подписи.
  3. Добавьте вашу подпись в заголовок `X-BAPI-API-KEY` и отправьте HTTP-запрос.

>Информация:  
>Примеры алгоритмов подписи можно найти [здесь](https://github.com/bybit-exchange/api-usage-examples).

Пример того, как создать простой текст для шифрования:

- GET

  ```python
  # правило:
  timestamp+api_key+recv_window+queryString

  # Примерные значения:
  timestamp = "1658384314791"
  api_key = "XXXXXXXXXX"
  recv_window = "5000"
  queryString = "category=option&symbol=BTC-29JUL22-25000-C"

  # Результирующая строка, которая должна быть подписана:
  "1658384314791XXXXXXXXXX5000category=option&symbol=BTC-29JUL22-25000-C"

  # Пример результирующей подписи для HMAC:
  "410e0f387bafb7afd0f1722c068515e09945610124fa11774da1da857b72f30b"
  ```

- POST

  ```python
  # правило:
  timestamp+api_key+recv_window+jsonBodyString
  
  # Примерные значения:
  timestamp = 1658385579423
  api_key = XXXXXXXXXX
  recv_window = 5000
  jsonBodyString = {"category": "option"}
  
  # Результирующая строка, которая должна быть подписана:
  1658385579423XXXXXXXXXX5000{"category": "option"}
  
  # Пример результирующей подписи для HMAC:
  "f0da71972ce1811c882ca5e3fd1779791fb1fed499bef40e5558e50259acfd66"
  ```

Примеры HTTP-запросов:

- GET

  ```bash
  GET /v5/order/realtime?category=option&symbol=BTC-29JUL22-25000-C HTTP/1.1
  Host: api-testnet.bybit.com
  -H 'X-BAPI-SIGN: XXXXXXXXXX' \
  -H 'X-BAPI-API-KEY: xxxxxxxxxxxxxxxxxx' \
  -H 'X-BAPI-TIMESTAMP: 1658384431891' \
  -H 'X-BAPI-RECV-WINDOW: 5000'
  ```

- POST

  ```bash
  POST /v5/order/create HTTP/1.1
  Host: api-testnet.bybit.com
  -H 'X-Referer: XXXXXXXXXX' \    [the header for broker users only]
  -H 'X-BAPI-SIGN: XXXXXXXXXX' \
  -H 'X-BAPI-API-KEY: xxxxxxxxxxxxxxxxxx' \
  -H 'X-BAPI-TIMESTAMP: 1658385589135' \
  -H 'X-BAPI-RECV-WINDOW: 5000' \
  -H 'Content-Type: application/json' \
  -d '{"category": "option"}'
  ```

<a id="общие-параметры-ответа"></a>

## Общие параметры ответа

```json
{
    "retCode": 0,
    "retMsg": "OK",
    "result": {},
    "retExtInfo": {},
    "time": 1671017382656
}
```

|Параметры  |Тип 	|Комментарии                                                                                                 |
|-----------|-------|---------------------------------------------------------------------------------------------------------|
|retCode    |number	|Код успеха/ошибки                                                                                        |
|retMsg     |string	|Сообщение успеха/ошибки. `"OK"`, `"success"`, `"SUCCESS"` или пустая строка указывают на успешный ответ  |
|result	    |Object |Результат бизнес-данных                                                                                  |
|retExtInfo |Object |Расширенная информация. В большинстве случаев это `{}`                                                   |
|time 	    |number |Текущая временная метка (мс)                                                                             |
